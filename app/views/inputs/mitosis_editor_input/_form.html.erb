<div class="mitosis-editor-wrapper"
     data-input-name="<%= input_html_options[:name] %>"
     data-height="<%= input_html_options[:data][:mit_height] %>"
     data-placeholder="<%= input_html_options[:data][:mit_placeholder] %>">
  <div id="mitosis-editor-<%= input_html_options[:id] %>" class="mitosis-editor-container"></div>
</div>

<script>
(function() {
  var container = document.getElementById('mitosis-editor-<%= input_html_options[:id] %>');
  var wrapper = container.closest('.mitosis-editor-wrapper');
  var inputName = wrapper.dataset.inputName;
  var height = wrapper.dataset.height || '500px';
  var placeholder = wrapper.dataset.placeholder || '';

  // Find the hidden input
  var hiddenInput = document.querySelector('input[name="' + inputName + '"]');

  if (window.MitosisEditor) {
    var editor = window.MitosisEditor.createEditor({
      container: container,
      content: hiddenInput ? hiddenInput.value : '',
      height: height,
      placeholder: placeholder
    });

    // Sync editor content to hidden input on form submit
    var form = container.closest('form');
    if (form) {
      form.addEventListener('submit', function() {
        if (hiddenInput && editor && editor.getMarkdown) {
          hiddenInput.value = editor.getMarkdown();
        }
      });
    }
  }
})();
</script>
